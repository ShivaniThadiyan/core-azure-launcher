{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json",
  "handler": "Microsoft.Compute.MultiVm",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [ 
    ],
    "steps": [
      {
        "name": "kubernetesConfig",
        "label": "Azure Kubernetes Service Settings",
        "subLabel": {
          "preValidation": "Configure the infrastructure settings",
          "postValidation": "Done"
        },
        "bladeTitle": "Azure Kubernetes Service Settings",
        "elements": [
          {
            "name": "aksClusterName",
            "type": "Microsoft.Common.TextBox",
            "label": "Cluster Name",
            "toolTip":" ",
            "defaultValue": "",
            "constraints": {
              "required": true,
              "regex": "^[a-z0-9A-Z-]{3,79}$",
              "validationMessage": "The Name must be between 3 and 79 characters long and contain letters, numbers and hyphens only."
            },
            "visible": true
          },
          {
            "name": "ClusterDNSPrefix",
            "type": "Microsoft.Common.TextBox",
            "label": "Cluster DNS Prefix",
            "toolTip":" ",
            "defaultValue": "",
            "constraints": {
              "required": true,
              "regex": "^[a-z0-9A-Z-]{3,79}$",
              "validationMessage": "The dns must be between 3 and 79 characters long and contain letters, numbers and hyphens only."
            },
            "visible": true
          },
          {
            "name": "NodeCount",
            "type": "Microsoft.Common.TextBox",
            "label": "Node Count",
            "toolTip":" ",
            "defaultValue": "3",
            "constraints": {
              "required": true
            },
            "visible": true
          },
          {
            "name": "EnableRBAC",
            "type": "Microsoft.Common.DropDown",
            "label": "Enable RBAC",
            "toolTip":" ",
            "defaultValue": "",
            "constraints": {
              "allowedValues": [
                {
                  "label": "Yes",
                  "value": "True"
                },
                {
                  "label": "No",
                  "value": "False"
                }
           ],
              "required": true
            },
            "visible": true
          },
          {
            "name": "KubernetesVersion",
            "type": "Microsoft.Common.DropDown",
            "label": "Kubernetes Version",
            "toolTip":" ",
            "defaultValue": "1.11.2",
            "constraints": {
              "allowedValues": [
                {
                  "label": "1.11.2",
                  "value": "1.11.2"
                },
                {
                  "label": "1.10.6",
                  "value": "1.10.6"
                },
                {
                  "label": "1.9.9",
                  "value": "1.9.9"
                }
              ],
              "required": true
            },
            "visible": true
          },
          {
            "name": "NodeVirtualMachineSize",
            "type": "Microsoft.Compute.SizeSelector",
            "label": "Node Virtual Machine Size",
            "toolTip": "The size of the agent VMs",
            "recommendedSizes": [
                "Standard_DS2_v2"
            ],
            "constraints": {
              "required": true,
              "allowedSizes": [
                "Standard_DS11",
                "Standard_DS11_v2",
                "Standard_DS12",
                "Standard_DS12_v2",
                "Standard_DS13",
                "Standard_DS13_v2",
                "Standard_DS14",
                "Standard_DS14_v2",
                "Standard_DS15_v2",
                "Standard_DS2",
                "Standard_DS2_v2",
                "Standard_DS3",
                "Standard_DS3_v2",
                "Standard_DS4",
                "Standard_DS4_v2",
                "Standard_DS5_v2",
                "Standard_F16",
                "Standard_F16s",
                "Standard_F2",
                "Standard_F2s",
                "Standard_F4",
                "Standard_F4s",
                "Standard_F8",
                "Standard_F8s",
                "Standard_G1",
                "Standard_G2",
                "Standard_NC6",
                "Standard_NC12",
                "Standard_NC24",
                "Standard_NC24r",
                "Standard_NV6",
                "Standard_NV12",
                "Standard_NV24",
                "Standard_B1s",
                "Standard_B1ms",
                "Standard_B2s",
                "Standard_B2ms",
                "Standard_B4ms",
                "Standard_B8ms"              
              ]
            },
            "osPlatform": "Linux",
            "count": 3
          },
          {
            "name": "ServicePrincipalAppID",
            "type": "Microsoft.Common.TextBox",
            "label": "Service Principal App ID",
            "toolTip":" ",
            "defaultValue": "",
            "constraints": {
              "required": true,
              "regex": "^[a-z0-9A-Z-]{3,79}$",
              "validationMessage": "The ID must be between 3 and 79 characters long and contain letters, numbers and hyphens only."
            },
            "visible": true
          },
          {
            "name": "ServicePrincipalSecret",
            "type": "Microsoft.Common.TextBox",
            "label": "Service Principal Secret",
            "toolTip":" ",
            "defaultValue": "",
            "constraints": {
              "required": true,
              "regex": "^[a-z0-9A-Z-]{3,79}$",
              "validationMessage": "The secret must be between 3 and 79 characters long and contain letters, numbers and hyphens only"
            },
            "visible": true
          }
        ]
      }
    ],
    "outputs": {
        "aksClusterName": "[steps('kubernetesConfig').aksClusterName]",
        "ClusterDNSPrefix":"[steps('kubernetesConfig').ClusterDNSPrefix]",
        "NodeCount":"[steps('kubernetesConfig').NodeCount]",
        "EnableRBAC":"[steps('kubernetesConfig').EnableRBAC]",
        "KubernetesVersion": "[steps('kubernetesConfig').KubernetesVersion]",
        "NodeVirtualMachineSize": "[steps('kubernetesConfig').NodeVirtualMachineSize]",
        "ServicePrincipalAppID": "[steps('kubernetesConfig').ServicePrincipalAppID]",
        "ServicePrincipalSecret": "[steps('kubernetesConfig').ServicePrincipalSecret]"
         }
  }
}
